"0","DefaultAssay(integrated)<- ""integrated"""
"0","Idents(object = integrated) <- integrated$integrated_snn_res.0.8"
"0","dd <- subset(integrated, idents = c(""2"", ""5"", ""10""), downsample=100)"
"0",""
"0","topvst <- head(VariableFeatures(dd), 500)"
"0","mat <- as.matrix(dd@assays$integrated@scale.data) #as.matrix(subset_dd@assays$integrated@scale.data)"
"0","mat <- mat[topvst,]"
"0",""
"0","genes <- c(GOI.lists$Biton_S1_ISC.I, GOI.lists$Biton_S1_ISC.II, GOI.lists$Biton_S1_ISC.III)"
"0","labels <- c(rep('Biton ISC I', length(GOI.lists$Biton_S1_ISC.I)), "
"0","            rep('Biton ISC II', length(GOI.lists$Biton_S1_ISC.II)), "
"0","            rep('Biton ISC III', length(GOI.lists$Biton_S1_ISC.III)))"
"0",""
"0","idxs <- which(genes %in% rownames(mat))"
"0","genes <- genes[idxs]"
"0","labels <- labels[idxs]"
"0","mat <- mat[genes,]"
"0",""
"0","ht <- Heatmap(mat, column_names_side = 'top', row_names_gp = gpar(fontsize = 9), column_names_gp = gpar(fontsize = 12),"
"0","              column_title = '', name = 'scaled data', column_labels = rep('', ncol(mat)),"
"0","              column_split = factor(as.character(dd$integrated_snn_res.0.8), levels = c('5', '2', '10')), "
"0","              row_split = labels, row_order = genes, #column_order = sort(colnames(mat)),"
"0","              cluster_column_slices = FALSE,"
"0","              top_annotation = HeatmapAnnotation(cluster = as.character(dd$integrated_snn_res.0.8)))"
"0",""
"0","draw(ht)"
